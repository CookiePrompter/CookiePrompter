<!DOCTYPE html>
<html lang="da">
<head>
	<title>Domain A: Parent</title>
	  <meta charset="utf-8">
	   <meta name="viewport" content="width=device-width, initial-scale=1.0">
	  <link rel="stylesheet" type="text/css" href="resources/css/bootstrap.min.css">
	  <link rel="stylesheet" type="text/css" href="resources/css/samples.css">
</head>
<body>
	<div class="top"></div>
	<div class="row-fluid">
		<div class="span2 sidebar"></div>
		<div class="span10">
			<h1>Domain A: Parent</h1>
			<button id="postbtn">Send to child</button> <br>
			<iframe id="childframer" src="http://domainb.dk/samples/domainB.html?sddfs" width="800" height="800"></iframe>



		</div>
	</div>
	<script type="text/javascript" src="resources/js/jquery.js"></script>
	<script type="text/javascript" src="../deploy/CookiePrompter.js"></script>
	<script type="text/javascript">
		CookiePrompter.init({
				readMoreUrl: 'readmore.html',
		        trackers: [{
		            name: GoogleAnalyticsTracker,
		            config: {
		                account: '1234'
		            }
		        }]
		    });


		var log = function (msg){
			console.log(msg);
		}

		var childdomain = 'http://domainb.dk';

		// helper function to setup crossbrowser postMessage calls
		function subscribeToPostMessage(func){
			log('setting up postmsg listeneer');
			if(func && typeof func ==='function'){
				var eventMethod = window.addEventListener ? "addEventListener" : "attachEvent";
				var eventer = window[eventMethod];
				var messageEvent = eventMethod == "attachEvent" ? "onmessage" : "message";
				eventer(messageEvent,func,false);
			}
		}

		function receiveMessage(msg){
			log('recieved msg from child frame:');
			log(msg);

			childdomain=msg.origin;
			var childframe = $('#childframer')[0];
			childframe.contentWindow.postMessage('cookiesAllowed:'+CookiePrompter.cookiesAllowed(),childdomain);
		}

		subscribeToPostMessage(receiveMessage);
		$(function(){
			$('#postbtn').click(function(){
				var childframe = $('#childframer')[0];
				childframe.contentWindow.postMessage('info from parent about cookiestatus',childdomain);
			});
		});

	</script>
	<footer></footer>
	<script type="text/javascript">	$(function(){$('.top').load('resources/topnav.html');$('.sidebar').load('resources/sidebar.html');	});</script>
</body>
</html>